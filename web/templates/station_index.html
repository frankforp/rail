{% extends 'template.html' %}
{% block content %}
    <div id="masonry">
    </div>
{% endblock %}
{% block script %}
    <script>
        $("a:contains('车站')").addClass('active');
        var img_start = 0;
        masonry(0);
        $(window).scroll(function () {
            masonry($(this).scrollTop())
        });

        function masonry(scrollTop) {
            if ($('#footer').offset().top < $(window).height() * 1.5 + scrollTop) {
                var img = {{ stations|safe }}[img_start];
                img_start = img_start + 1;
                var a = $('<a>').attr('href', '{% url 'station' '*' %}'.replace('*', img.cn)).append($('<img>').addClass('img-thumbnail').attr({
                    'alt': img.cn,
                    'src': '{{ qiniu }}' + img.cn + '{{ format }}',
                    'text': img.cn
                }));
                $('#masonry').append(a).masonry('appended', a).masonry({itemSelector: 'a'});
                {#                $('#masonry a').css('padding', '5px');#}
                $('#masonry').imagesLoaded(masonry(scrollTop))
            }
        }

    </script>
{% endblock %}